#!/bin/bash

#{IMAGE_NAME}
IMAGE_NAME=$1
# ${SEBAL_MOUNT_POINT}/$IMAGES_DIR_NAME/
IMAGES_DIR_PATH=$2
# ${SEBAL_MOUNT_POINT}/$RESULTS_DIR_NAME/
RESULTS_DIR_PATH=$3
# ${SEBAL_MOUNT_POINT}/$RESULTS_DIR_NAME/${IMAGE_NAME}
OUTPUT_IMAGE_DIR=$4
# ${SEBAL_MOUNT_POINT}/$IMAGES_DIR_NAME/${IMAGE_NAME}/${IMAGE_NAME}"_MTL.txt"
IMAGE_MTL_PATH=$5
# ${SEBAL_MOUNT_POINT}/$IMAGES_DIR_NAME/${IMAGE_NAME}/${IMAGE_NAME}"_MTLFmask"
IMAGE_MTL_FMASK_PATH=$6
# ${SEBAL_MOUNT_POINT}/$RESULTS_DIR_NAME/${IMAGE_NAME}/${IMAGE_NAME}"_station.csv"
IMAGE_STATION_FILE_PATH=$7

IMAGE_REPOSITORY_URL="http://www2.lsd.ufcg.edu.br/~esdras/LT52150651984361CUB00-output.tar.gz"

if [ "$IMAGE_NAME" = "LT52150651984361CUB00" ]; then

	ACTUAL_FILE=$RESULTS_DIR_PATH"/"LT52150651984361CUB00-output.tar.gz

	echo "Getting file $IMAGE_REPOSITORY_URL to $ACTUAL_FILE"
	sudo wget $IMAGE_REPOSITORY_URL -O $ACTUAL_FILE

	echo "Extracting: tar -xvzf $ACTUAL_FILE $OUTPUT_IMAGE_DIR"
	sudo tar -xvf $ACTUAL_FILE -C $RESULTS_DIR_PATH

	sudo rm -rf $ACTUAL_FILE

	# Global variables
	WORKER_RUN_LOG_FILE=/var/log/static-worker-run.log
	WORKER_RUN_LOG_MESSAGE="$(date):: Going to stop script with error"

	sudo echo "$WORKER_RUN_LOG_MESSAGE" >> "$WORKER_RUN_LOG_FILE"

	exit 0
fi

echo "INVALID IMAGE"
exit 1
